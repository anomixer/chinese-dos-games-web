{% extends 'base.html' %}


{% block title %}{% if lang == 'zh-Hans' %}关于{% else %}關於{% endif %}{% endblock %}
{% block main %}
    <div class="container mt-3">
<h2>{% if lang == 'zh-Hans' %}中文 DOS 游戏{% else %}中文 DOS 遊戲{% endif %} 🎮</h2>
<h3>{% if lang == 'zh-Hans' %}项目地址{% else %}專案位址{% endif %}</h3>
        <p><a href="https://github.com/rwv/chinese-dos-games">https://github.com/rwv/chinese-dos-games</a></p>

<h3>{% if lang == 'zh-Hans' %}游戏列表{% else %}遊戲列表{% endif %}</h3>
        <p>
            {% if games %}
                <ul>
                    {% for key, game_info in games.items() %}
                        <li>
<a href="{{ url_for('game', identifier=game_info['identifier']) }}">{{ game_info['name'][lang] }}</a>
                        </li>
                    {% endfor %}
                </ul>
            {% endif %}
        </p>

<h3>{% if lang == 'zh-Hans' %}感谢{% else %}感謝{% endif %}</h3>
        <p>
        <ul>
            <li><a href="https://github.com/dreamlayers/em-dosbox" target="_blank">dreamlayers/em-dosbox: An Emscripten
                port of DOSBox</a></li>
            <li><a href="https://github.com/db48x/emularity" target="_blank">db48x/emularity: easily embed emulators</a></li>
                
        </ul>
        </p>
<h3>{% if lang == 'zh-Hans' %}缓存{% else %}快取{% endif %}</h3>
        <p>
            {% if cache_info %}
                {% if lang == 'zh-Hans' %}
                    当前缓存：{{ cache_info.total_human }} / {{ cache_info.max_human }}（{{ cache_info.count }} 个文件）
                {% else %}
                    目前快取：{{ cache_info.total_human }} / {{ cache_info.max_human }}（共 {{ cache_info.count }} 個檔案）
                {% endif %}
                <br>
                <small>{% if lang == 'zh-Hans' %}可通过环境变量 GAMES_CACHE_MAX_GB 调整上限。{% else %}可透過環境變數 GAMES_CACHE_MAX_GB 調整上限。{% endif %}</small>
            {% endif %}
        </p>

        {% if mode_info %}
        <h3>{% if lang == 'zh-Hans' %}模式与来源{% else %}模式與來源{% endif %}</h3>
        <p>
            <div><strong>Mode:</strong> {{ mode_info.mode }}</div>
            <div><strong>REMOTE_PREFIX:</strong> {{ mode_info.REMOTE_PREFIX }}</div>
            <div class="text-muted small">
                USE_STREAM_PROXY={{ 1 if mode_info.USE_STREAM_PROXY else 0 }},
                USE_REMOTE_MOUNT={{ 1 if mode_info.USE_REMOTE_MOUNT else 0 }},
                DISABLE_BIN_ROUTE={{ 1 if mode_info.DISABLE_BIN_ROUTE else 0 }},
                STREAM_TIMEOUT_SECS={{ mode_info.STREAM_TIMEOUT_SECS }},
                STREAM_FALLBACK_TO_BIN={{ 1 if mode_info.STREAM_FALLBACK_TO_BIN else 0 }}
            </div>
        </p>
        <div class="mt-2">
            <button class="btn btn-sm btn-outline-primary" onclick="copyEnvPS()">{% if lang == 'zh-Hans' %}一键复制当前环境变量（PowerShell）{% else %}一鍵複製目前環境變數（PowerShell）{% endif %}</button>
            <span id="copy_status" class="ml-2 text-muted" style="display:none"></span>
        </div>
        <script>
            function copyEnvPS() {
                try {
                    const mi = {{ mode_info | tojson }};
                    const lines = [];
                    // 依目前模式輸出建議的指令
                    if (mi.REMOTE_PREFIX) lines.push(`$env:REMOTE_PREFIX = '${mi.REMOTE_PREFIX}'`);
                    lines.push(`$env:USE_STREAM_PROXY = ${mi.USE_STREAM_PROXY ? 1 : 0}`);
                    lines.push(`$env:USE_REMOTE_MOUNT = ${mi.USE_REMOTE_MOUNT ? 1 : 0}`);
                    lines.push(`$env:DISABLE_BIN_ROUTE = ${mi.DISABLE_BIN_ROUTE ? 1 : 0}`);
                    lines.push(`$env:STREAM_TIMEOUT_SECS = ${mi.STREAM_TIMEOUT_SECS}`);
                    lines.push(`$env:STREAM_FALLBACK_TO_BIN = ${mi.STREAM_FALLBACK_TO_BIN ? 1 : 0}`);
                    lines.push(`python app.py`);
                    const text = lines.join('\n');
                    navigator.clipboard.writeText(text).then(() => {
                        const s = document.getElementById('copy_status');
                        s.textContent = '{{ "已複製" if lang == "zh-Hans" else "已複製" }}';
                        s.style.display = '';
                        setTimeout(() => { s.style.display = 'none'; }, 1500);
                    });
                } catch (e) {
                    alert('Copy failed: ' + e);
                }
            }
        </script>
        {% endif %}

        <h3>{% if lang == 'zh-Hans' %}许可{% else %}許可{% endif %}</h3>
        <p><a href="https://www.gnu.org/licenses/gpl-3.0.html">The GNU General Public License v3.0</a></p>
    </div>
{% endblock %}
